#include <tunables/global>

/opt/sensu/embedded/bin/sensu-client flags=(complain) {
  #include <abstractions/base>
  #include <abstractions/bash>
  #include <abstractions/nameservice>
  #include <abstractions/ruby>
  #include <abstractions/ubuntu-konsole>

  capability sys_ptrace,



  /bin/bash rix,
  /bin/dash rix,
  /bin/grep rix,
  /bin/ps rix,
  /bin/uname rix,
  /etc/sensu/*/ r,
  /etc/sensu/community/plugins/processes/check-procs.rb rix,
  /etc/sensu/community/plugins/system/check-memory-pcnt.sh rix,
  /etc/sensu/conf.d/* r,
  /etc/sensu/conf.d/*/ r,
  /etc/sensu/conf.d/checks/* r,
  /etc/sensu/plugins/** rix,
  /opt/sensu/** mr,
  /opt/sensu/embedded/bin/ruby ix,
  /proc/ r,
  /proc/*/cmdline r,
  /proc/*/maps r,
  /proc/*/stat r,
  /proc/*/status r,
  /proc/meminfo r,
  /proc/sys/kernel/pid_max r,
  /proc/uptime r,
  /proc/version r,
  /run/sensu/sensu-client.pid w,
  /usr/bin/bc rix,
  /usr/bin/cut rix,
  /usr/bin/env r,
  /usr/bin/free rix,
  /usr/bin/mawk rix,
  /usr/lib{,32,64}/** mr,
  /var/log/sensu/* w,

}
